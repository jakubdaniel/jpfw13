\ProvidesPackage{beamerthemeD3S}[2013/09/24]

\beamertemplatenavigationsymbolsempty

\useoutertheme{split}

\usepackage{shadowtext}
\usepackage{forloop}  
\usepackage[trim]{tokenizer}  
\usepackage[iso,yyyymmdd]{datetime}

\newcounter{rrCount}  
\newcommand{\replace}[3]{% 
  \GetTokens{rrFirst}{rrRest}{#3#1}%
  \rrFirst%
  \forloop{rrCount}{0}{\value{rrCount} < 100}{%
    \ifthenelse{\equal{\rrRest}{}}{%
      \setcounter{rrCount}{101}%
    }{% 
      \GetTokens{rrFirst}{rrRest}{\rrRest}%
      #2\rrFirst%
    }%  
  }%  
}

\setbeamercolor{frametitle}{fg=black}
\setbeamertemplate{itemize item}{\includegraphics[width=1ex,keepaspectratio]{Item}}
\setbeamertemplate{itemize subitem}{\includegraphics[width=1ex,keepaspectratio]{SubItem}}
\setbeamertemplate{itemize subsubitem}{\includegraphics[width=1ex,keepaspectratio]{SubSubItem}}

\def\titleframe{%
  {%
    \setbeamertemplate{headline}{}%
    \setbeamertemplate{frametitle}{}%
    \setbeamertemplate{footline}{}%
    \setbeamertemplate{background canvas}[vertical shading][top=white,bottom=gray!25]%
    \frame{\titlepage}%
  }%
  \addtocounter{framenumber}{-1}%
}

\setbeamertemplate{background canvas}{%
  \vbox to \dimexpr\paperheight - 1em\relax {%
    \vfill%
    \hbox to \paperwidth {\hfill \includegraphics[scale=0.15]{D3SWM}}%
  }%
}

\setbeamertemplate{frametitle}{%
  \vspace{-1cm}%
  \fontsize{16}{16}\selectfont%
  \shadowoffset{0.75pt}%
  \shadowtext{\insertframetitle}%
}

\setbeamertemplate{headline}{%
  \vspace{1cm}%
  \includegraphics[width=\paperwidth]{Head}%
}

\setbeamertemplate{footline}{%
  {%
    \colorbox{gray!50}{%
      \makebox[\paperwidth][c]{%
        \makebox[\dimexpr \paperwidth - 1cm\relax]{%
          {\bf \fontsize{4}{4}\selectfont \insertauthor}%
          {\fontsize{4}{4}\selectfont, D3S Seminar, \today}%
          \hfill%
          {\bf \fontsize{4}{4}\selectfont \inserttitle}%
          \hfill%
          {\bf \fontsize{4}{4}\selectfont \insertframenumber}%
        }%
      }%
    }%
  }%
}

\setbeamertemplate{title page}{%
  \vbox to 1.5cm {%
    \shadowoffset{0.75pt}\shadowtext{\parbox{\textwidth}{\centering \bf \fontsize{24}{24}\selectfont \inserttitle}}%
  }%
  \colorbox{gray}{%
    \makebox[\textwidth][l]{%
      \bf \fontsize{6}{6}\selectfont \color{white} http://d3s.mff.cuni.cz%
    }%
  }%
  \vspace{0.25cm}%
  \begin{columns}[b]%
    \begin{column}[T]{\dimexpr 0.5\textwidth - 0.75cm\relax}%
      \includegraphics[width=4cm,keepaspectratio]{D3S} \\%
      \vspace{0.5cm}%
      \hspace{1cm} \includegraphics[width=2cm,keepaspectratio]{CUNI} \\%
      \makebox[4cm][c]{\bf \fontfamily{ppl}\fontsize{6}{6}\selectfont \color{gray} CHARLES UNIVERSITY IN PRAGUE} \\%
      \colorbox{gray}{\makebox[4cm][c]{\bf \fontfamily{ppl}\fontsize{6}{6}\selectfont \color{white} faculty of mathematics and physics}} \\%
    \end{column}%
    \begin{column}[T]{\dimexpr 0.5\textwidth - 0.75cm\relax}%
      \raggedleft \it%
      \replace{, }{\\}{\insertauthor}%
    \end{column}%
  \end{columns}%
}
